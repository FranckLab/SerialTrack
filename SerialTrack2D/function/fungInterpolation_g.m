function Vq = fungInterpolation_g(Xq,Yq,I)

x0 = floor(Xq) - 1;
y0 = floor(Yq) - 1;
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% I = f(x0:(x0+3), y0:(y0+3));
Dx = [1 1 1 1 1; 
      2 2 2 2 2;
      Xq-x0+1 Xq-x0+1 Xq-x0+1 Xq-x0+1 Xq-x0+1; 
      3 3 3 3 3; 
      4 4 4 4 4];
Dy = [1 2 Yq-y0+1 3 4;
      1 2 Yq-y0+1 3 4;
      1 2 Yq-y0+1 3 4;
      1 2 Yq-y0+1 3 4;
      1 2 Yq-y0+1 3 4];
I2 = ba_interp2(I,Dy,Dx,'cubic');
Vq = I2(3,3);
%%%%%%%%%% figure;
%%%%%%%%%% mesh(Dx,Dy,I2)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% [X,Y] = ndgrid(x0:x0+3,y0:y0+3);
% % V = f(x0:x0+3,y0:y0+3);
% 
% F = griddedInterpolant(X,Y,I,'cubic'); 
% Vq = F(Xq,Yq);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
% %%%%%%%%%%%%%%%%%%%Plot%%%%%%%%%%%%%%%%
% [Xq,Yq] = ndgrid(1:0.5:10,1:0.5:10);
% Vq = F(Xq,Yq);
% mesh(Xq,Yq,Vq);
% 
% function gInterpolation  =  fungInterpolation_g(x,y,g)
%  
% 
% x0 = floor(x)  ;
% y0 = floor(x)  ;
% x1 = x0+1;  
% y1 = y0+1;  
% 
% p = x - x1;
% q = y - y1;
%  
% gInterpolation = (-1/6*p*(p-1)*(p-2))*(-1/6*q*(q-1)*(q-2))*g(1,1) + ...
%     (-1/6*p*(p-1)*(p-2))*(1/2*(q+1)*(q-1)*(q-2))*g(1,2) + ...
%     (-1/6*p*(p-1)*(p-2))*(-1/2*(q+1)*q*(q-2))*g(1,3) + ...
%     (-1/6*p*(p-1)*(p-2))*(1/6*(q+1)*(q)*(q-1))*g(1,4) + ...
%     ...
%     (1/2*(p+1)*(p-1)*(p-2))*(-1/6*q*(q-1)*(q-2))*g(2,1) + ...
%     (1/2*(p+1)*(p-1)*(p-2))*(1/2*(q+1)*(q-1)*(q-2))*g(2,2) + ...
%     (1/2*(p+1)*(p-1)*(p-2))*(-1/2*(q+1)*q*(q-2))*g(2,3) + ...
%     (1/2*(p+1)*(p-1)*(p-2))*(1/6*(q+1)*(q)*(q-1))*g(2,4) + ...
%     ...
%     (-1/2*(p+1)*p*(p-2))*(-1/6*q*(q-1)*(q-2))*g(3,1) + ...
%     (-1/2*(p+1)*p*(p-2))*(1/2*(q+1)*(q-1)*(q-2))*g(3,2) + ...
%     (-1/2*(p+1)*p*(p-2))*(-1/2*(q+1)*q*(q-2))*g(3,3) + ...
%     (-1/2*(p+1)*p*(p-2))*(1/6*(q+1)*(q)*(q-1))*g(3,4) + ...
%     ...
%     (1/6*p*(p-1)*(p+1))*(-1/6*q*(q-1)*(q-2))*g(4,1) + ...
%     (1/6*p*(p-1)*(p+1))*(1/2*(q+1)*(q-1)*(q-2))*g(4,2) + ...
%     (1/6*p*(p-1)*(p+1))*(-1/2*(q+1)*q*(q-2))*g(4,3) + ...
%     (1/6*p*(p-1)*(p+1))*(1/6*(q+1)*(q)*(q-1))*g(4,4);
